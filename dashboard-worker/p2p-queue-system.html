<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fire22 P2P Queue System</title>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="src/styles/framework.css">
    <style>
        /* Custom styles specific to P2P Queue System */
        body { 
            font-family: var(--font-family-primary);
            margin: 0; 
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            color: var(--text-primary); 
            min-height: 100vh;
        }
        .header { 
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-overlay));
            padding: var(--spacing-lg); 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            box-shadow: var(--shadow-md);
            border-bottom: 1px solid var(--border-primary);
        }
        .queue-card { 
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-overlay));
            padding: var(--spacing-lg); 
            border-radius: var(--radius-lg); 
            border: 1px solid var(--border-primary);
            box-shadow: var(--shadow-lg);
            transition: all var(--transition-normal);
        }
        .queue-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }
        .status-badge { 
            padding: var(--spacing-xs) var(--spacing-md); 
            border-radius: var(--radius-lg); 
            font-size: var(--text-sm); 
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .status-pending { background: linear-gradient(135deg, var(--color-warning), #d97706); color: white; }
        .status-matched { background: linear-gradient(135deg, var(--color-success), #059669); color: white; }
        .status-processing { background: linear-gradient(135deg, var(--color-info), #4f46e5); color: white; }
        .status-completed { background: linear-gradient(135deg, var(--color-success), #059669); color: white; }
        .status-failed { background: linear-gradient(135deg, var(--color-error), #dc2626); color: white; }
        .match-score { 
            font-size: 1.5rem; 
            font-weight: 800; 
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .telegram-info {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border: 1px solid #475569;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 0.5rem 0;
        }
        .action-button {
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--radius-md);
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-normal);
            margin: var(--spacing-xs);
        }
        .btn-primary { background: linear-gradient(135deg, var(--color-info), #4f46e5); color: white; }
        .btn-success { background: linear-gradient(135deg, var(--color-success), #059669); color: white; }
        .btn-warning { background: linear-gradient(135deg, var(--color-warning), #d97706); color: white; }
        .btn-danger { background: linear-gradient(135deg, var(--color-error), #dc2626); color: white; }
        .btn-primary:hover, .btn-success:hover, .btn-warning:hover, .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        .filter-section {
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-overlay));
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        .filter-input {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
            padding: var(--spacing-xs);
            border-radius: var(--radius-md);
            margin: var(--spacing-xs);
        }
        .filter-input:focus {
            outline: none;
            border-color: #6366f1;
        }
    </style>
</head>
<body>
    <div x-data="p2pQueueSystem()" x-init="init()">
        <!-- Header -->
        <div class="header">
            <div>
                <h1 class="text-2xl font-bold">🔥 Fire22 P2P Queue System</h1>
                <p class="text-sm text-gray-400">Peer-to-Peer Transaction Management</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <div class="text-sm text-gray-400">Queue Status</div>
                    <div class="text-lg font-bold" x-text="queueStats.totalItems"></div>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Matched Pairs</div>
                    <div class="text-lg font-bold text-green-400" x-text="queueStats.matchedPairs"></div>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Success Rate</div>
                    <div class="text-lg font-bold text-blue-400" x-text="queueStats.successRate + '%'"></div>
                </div>
            </div>
        </div>

        <!-- Filters and Controls -->
        <div class="filter-section">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label class="block text-sm font-medium mb-2">Payment Type</label>
                    <select x-model="filters.paymentType" class="filter-input w-full">
                        <option value="">All Types</option>
                        <option value="bank_transfer">Bank Transfer</option>
                        <option value="crypto">Crypto</option>
                        <option value="paypal">PayPal</option>
                        <option value="venmo">Venmo</option>
                        <option value="zelle">Zelle</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Amount Range</label>
                    <div class="flex space-x-2">
                        <input type="number" x-model="filters.minAmount" placeholder="Min" class="filter-input flex-1">
                        <input type="number" x-model="filters.maxAmount" placeholder="Max" class="filter-input flex-1">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Telegram Group</label>
                    <input type="text" x-model="filters.telegramGroupId" placeholder="Group ID" class="filter-input w-full">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Status</label>
                    <select x-model="filters.status" class="filter-input w-full">
                        <option value="">All Statuses</option>
                        <option value="pending">Pending</option>
                        <option value="matched">Matched</option>
                        <option value="processing">Processing</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-between items-center mt-4">
                <div class="flex space-x-2">
                    <button @click="refreshQueue()" class="action-button btn-primary">
                        <i class="fas fa-sync-alt mr-2"></i>Refresh
                    </button>
                    <button @click="autoMatch()" class="action-button btn-success">
                        <i class="fas fa-magic mr-2"></i>Auto-Match
                    </button>
                    <button @click="exportQueue()" class="action-button btn-warning">
                        <i class="fas fa-download mr-2"></i>Export
                    </button>
                </div>
                <div class="text-sm text-gray-400">
                    Last updated: <span x-text="lastUpdated"></span>
                </div>
            </div>
        </div>

        <!-- Queue Items -->
        <div class="p-6">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Withdrawals Queue -->
                <div class="queue-card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-red-400">
                            <i class="fas fa-arrow-up mr-2"></i>Withdrawals Queue
                        </h2>
                        <span class="status-badge status-pending" x-text="withdrawalsQueue.length + ' items'"></span>
                    </div>
                    <div class="space-y-3 max-h-96 overflow-y-auto">
                        <template x-for="item in filteredWithdrawals" :key="item.id">
                            <div class="bg-gray-800 rounded-lg p-4 border-l-4 border-red-500">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex-1">
                                        <div class="font-semibold" x-text="'$' + item.amount.toLocaleString()"></div>
                                        <div class="text-sm text-gray-400" x-text="item.paymentType"></div>
                                        <div class="text-xs text-gray-500" x-text="'Customer: ' + item.customerId"></div>
                                    </div>
                                    <div class="text-right">
                                        <div class="status-badge" :class="'status-' + item.status" x-text="item.status"></div>
                                        <div class="text-xs text-gray-500 mt-1" x-text="formatDate(item.createdAt)"></div>
                                    </div>
                                </div>
                                
                                <!-- Telegram Integration -->
                                <div class="telegram-info mt-3">
                                    <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div>
                                            <span class="text-gray-400">Group:</span>
                                            <span x-text="item.telegramGroupId || 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-400">Chat:</span>
                                            <span x-text="item.telegramChatId || 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-400">Channel:</span>
                                            <span x-text="item.telegramChannel || 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-400">Username:</span>
                                            <span x-text="item.telegramUsername || 'N/A'"></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Actions -->
                                <div class="flex flex-wrap gap-2 mt-3">
                                    <button @click="viewDetails(item)" class="action-button btn-primary">
                                        <i class="fas fa-eye mr-1"></i>View
                                    </button>
                                    <button @click="editItem(item)" class="action-button btn-warning">
                                        <i class="fas fa-edit mr-1"></i>Edit
                                    </button>
                                    <button @click="cancelItem(item)" class="action-button btn-danger">
                                        <i class="fas fa-times mr-1"></i>Cancel
                                    </button>
                                    <button @click="notifyTelegram(item)" class="action-button btn-success">
                                        <i class="fab fa-telegram mr-1"></i>Notify
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Deposits Queue -->
                <div class="queue-card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-green-400">
                            <i class="fas fa-arrow-down mr-2"></i>Deposits Queue
                        </h2>
                        <span class="status-badge status-pending" x-text="depositsQueue.length + ' items'"></span>
                    </div>
                    <div class="space-y-3 max-h-96 overflow-y-auto">
                        <template x-for="item in filteredDeposits" :key="item.id">
                            <div class="bg-gray-800 rounded-lg p-4 border-l-4 border-green-500">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex-1">
                                        <div class="font-semibold" x-text="'$' + item.amount.toLocaleString()"></div>
                                        <div class="text-sm text-gray-400" x-text="item.paymentType"></div>
                                        <div class="text-xs text-gray-500" x-text="'Customer: ' + item.customerId"></div>
                                    </div>
                                    <div class="text-right">
                                        <div class="status-badge" :class="'status-' + item.status" x-text="item.status"></div>
                                        <div class="text-xs text-gray-500 mt-1" x-text="formatDate(item.createdAt)"></div>
                                    </div>
                                </div>
                                
                                <!-- Telegram Integration -->
                                <div class="telegram-info mt-3">
                                    <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div>
                                            <span class="text-gray-400">Group:</span>
                                            <span x-text="item.telegramGroupId || 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-400">Chat:</span>
                                            <span x-text="item.telegramChatId || 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-400">Channel:</span>
                                            <span x-text="item.telegramChannel || 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-400">Username:</span>
                                            <span x-text="item.telegramUsername || 'N/A'"></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Actions -->
                                <div class="flex flex-wrap gap-2 mt-3">
                                    <button @click="viewDetails(item)" class="action-button btn-primary">
                                        <i class="fas fa-eye mr-1"></i>View
                                    </button>
                                    <button @click="editItem(item)" class="action-button btn-warning">
                                        <i class="fas fa-edit mr-1"></i>Edit
                                    </button>
                                    <button @click="cancelItem(item)" class="action-button btn-danger">
                                        <i class="fas fa-times mr-1"></i>Cancel
                                    </button>
                                    <button @click="notifyTelegram(item)" class="action-button btn-success">
                                        <i class="fab fa-telegram mr-1"></i>Notify
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>

            <!-- Matching Opportunities -->
            <div class="queue-card mt-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-blue-400">
                        <i class="fas fa-link mr-2"></i>Matching Opportunities
                    </h2>
                    <span class="status-badge status-matched" x-text="matchingOpportunities.length + ' matches'"></span>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <template x-for="match in matchingOpportunities" :key="match.id">
                        <div class="bg-gray-800 rounded-lg p-4 border border-blue-500">
                            <div class="text-center mb-3">
                                <div class="match-score" x-text="match.matchScore + ' pts'"></div>
                                <div class="text-sm text-gray-400">Match Score</div>
                            </div>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Withdrawal:</span>
                                    <span x-text="'$' + match.withdrawalAmount"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Deposit:</span>
                                    <span x-text="'$' + match.depositAmount"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Type:</span>
                                    <span x-text="match.paymentType"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Wait Time:</span>
                                    <span x-text="formatWaitTime(match.waitTime)"></span>
                                </div>
                            </div>
                            <div class="flex gap-2 mt-3">
                                <button @click="approveMatch(match)" class="action-button btn-success flex-1">
                                    <i class="fas fa-check mr-1"></i>Approve
                                </button>
                                <button @click="rejectMatch(match)" class="action-button btn-danger flex-1">
                                    <i class="fas fa-times mr-1"></i>Reject
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Modal for Item Details -->
        <div x-show="showModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">Item Details</h3>
                    <button @click="showModal = false" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div x-show="selectedItem">
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Amount</label>
                            <div class="text-lg font-bold" x-text="'$' + selectedItem.amount"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Status</label>
                            <div class="status-badge" :class="'status-' + selectedItem.status" x-text="selectedItem.status"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Payment Type</label>
                            <div x-text="selectedItem.paymentType"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Created</label>
                            <div x-text="formatDate(selectedItem.createdAt)"></div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-1">Notes</label>
                        <textarea x-model="selectedItem.notes" class="filter-input w-full h-20"></textarea>
                    </div>
                    <div class="flex justify-end gap-2">
                        <button @click="updateItem(selectedItem)" class="action-button btn-success">
                            <i class="fas fa-save mr-1"></i>Save Changes
                        </button>
                        <button @click="showModal = false" class="action-button btn-primary">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function p2pQueueSystem() {
            return {
                // Data
                withdrawalsQueue: [],
                depositsQueue: [],
                matchingOpportunities: [],
                queueStats: {
                    totalItems: 0,
                    matchedPairs: 0,
                    successRate: 0
                },
                filters: {
                    paymentType: '',
                    minAmount: '',
                    maxAmount: '',
                    telegramGroupId: '',
                    status: ''
                },
                showModal: false,
                selectedItem: null,
                lastUpdated: 'Never',

                // Methods
                init() {
                    this.loadQueueData();
                    this.startAutoRefresh();
                },

                async loadQueueData() {
                    try {
                        // Real API calls to HMR development server
                        const [withdrawals, deposits, matches, stats] = await Promise.all([
                            this.fetchWithdrawals(),
                            this.fetchDeposits(),
                            this.fetchMatchingOpportunities(),
                            this.fetchQueueStats()
                        ]);

                        this.withdrawalsQueue = withdrawals;
                        this.depositsQueue = deposits;
                        this.matchingOpportunities = matches;
                        this.queueStats = stats;
                        this.lastUpdated = new Date().toLocaleTimeString();
                    } catch (error) {
                        console.error('Failed to load queue data:', error);
                    }
                },

                async fetchWithdrawals() {
                    // Real API call to HMR development server
                    try {
                        const response = await fetch('/api/p2p/queue/withdrawals');
                        if (!response.ok) throw new Error('Failed to fetch withdrawals');
                        return await response.json();
                    } catch (error) {
                        console.error('Error fetching withdrawals:', error);
                        // Fallback mock data
                        return [
                        {
                            id: 'w1',
                            type: 'withdrawal',
                            customerId: 'CUST001',
                            amount: 500,
                            paymentType: 'bank_transfer',
                            status: 'pending',
                            createdAt: new Date(Date.now() - 3600000),
                            telegramGroupId: 'TG_GROUP_001',
                            telegramChatId: 'CHAT_001',
                            telegramChannel: 'CHANNEL_MAIN',
                            telegramUsername: '@user1',
                            notes: 'Priority withdrawal request'
                        },
                        {
                            id: 'w2',
                            type: 'withdrawal',
                            customerId: 'CUST002',
                            amount: 1200,
                            paymentType: 'crypto',
                            status: 'matched',
                            createdAt: new Date(Date.now() - 7200000),
                            telegramGroupId: 'TG_GROUP_002',
                            telegramChatId: 'CHAT_002',
                            telegramChannel: 'CHANNEL_VIP',
                            telegramUsername: '@user2',
                            notes: 'VIP customer'
                        }
                    ];
                },

                async fetchDeposits() {
                    // Real API call to HMR development server
                    try {
                        const response = await fetch('/api/p2p/queue/deposits');
                        if (!response.ok) throw new Error('Failed to fetch deposits');
                        return await response.json();
                    } catch (error) {
                        console.error('Error fetching deposits:', error);
                        // Fallback mock data
                    return [
                        {
                            id: 'd1',
                            type: 'deposit',
                            customerId: 'CUST003',
                            amount: 800,
                            paymentType: 'bank_transfer',
                            status: 'pending',
                            createdAt: new Date(Date.now() - 1800000),
                            telegramGroupId: 'TG_GROUP_001',
                            telegramChatId: 'CHAT_003',
                            telegramChannel: 'CHANNEL_MAIN',
                            telegramUsername: '@user3',
                            notes: 'New customer deposit'
                        },
                        {
                            id: 'd2',
                            type: 'deposit',
                            customerId: 'CUST004',
                            amount: 1500,
                            paymentType: 'crypto',
                            status: 'pending',
                            createdAt: new Date(Date.now() - 5400000),
                            telegramGroupId: 'TG_GROUP_002',
                            telegramChatId: 'CHAT_004',
                            telegramChannel: 'CHANNEL_VIP',
                            telegramUsername: '@user4',
                            notes: 'Large crypto deposit'
                        }
                    ];
                },

                async fetchMatchingOpportunities() {
                    // Real API call to HMR development server
                    try {
                        const response = await fetch('/api/p2p/queue/matches');
                        if (!response.ok) throw new Error('Failed to fetch matches');
                        return await response.json();
                    } catch (error) {
                        console.error('Error fetching matches:', error);
                        // Fallback mock data
                    return [
                        {
                            id: 'm1',
                            withdrawalId: 'w1',
                            depositId: 'd1',
                            withdrawalAmount: 500,
                            depositAmount: 800,
                            paymentType: 'bank_transfer',
                            matchScore: 85,
                            waitTime: 3600000
                        }
                    ];
                },

                async fetchQueueStats() {
                    // Real API call to HMR development server
                    try {
                        const response = await fetch('/api/p2p/queue/stats');
                        if (!response.ok) throw new Error('Failed to fetch stats');
                        return await response.json();
                    } catch (error) {
                        console.error('Error fetching stats:', error);
                        // Fallback mock data
                    return {
                        totalItems: 4,
                        matchedPairs: 1,
                        successRate: 95
                    };
                },

                // Computed properties
                get filteredWithdrawals() {
                    return this.withdrawalsQueue.filter(item => this.matchesFilter(item));
                },

                get filteredDeposits() {
                    return this.depositsQueue.filter(item => this.matchesFilter(item));
                },

                matchesFilter(item) {
                    if (this.filters.paymentType && item.paymentType !== this.filters.paymentType) return false;
                    if (this.filters.minAmount && item.amount < parseFloat(this.filters.minAmount)) return false;
                    if (this.filters.maxAmount && item.amount > parseFloat(this.filters.maxAmount)) return false;
                    if (this.filters.telegramGroupId && item.telegramGroupId !== this.filters.telegramGroupId) return false;
                    if (this.filters.status && item.status !== this.filters.status) return false;
                    return true;
                },

                // Actions
                async refreshQueue() {
                    await this.loadQueueData();
                },

                async autoMatch() {
                    try {
                        console.log('Running auto-matching algorithm...');
                        const response = await fetch('/api/p2p/queue/auto-match', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' }
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            console.log('Auto-match result:', result);
                            alert(`Auto-matching complete: ${result.matchesFound} matches found, ${result.matchesApproved} approved`);
                        }
                        
                        await this.loadQueueData();
                    } catch (error) {
                        console.error('Auto-matching failed:', error);
                        alert('Auto-matching failed. Please try again.');
                    }
                },

                async exportQueue() {
                    try {
                        const data = {
                            withdrawals: this.withdrawalsQueue,
                            deposits: this.depositsQueue,
                            matches: this.matchingOpportunities,
                            stats: this.queueStats,
                            exportedAt: new Date().toISOString()
                        };
                        
                        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `p2p-queue-export-${new Date().toISOString().split('T')[0]}.json`;
                        a.click();
                        URL.revokeObjectURL(url);
                    } catch (error) {
                        console.error('Export failed:', error);
                    }
                },

                viewDetails(item) {
                    this.selectedItem = { ...item };
                    this.showModal = true;
                },

                editItem(item) {
                    this.viewDetails(item);
                },

                async cancelItem(item) {
                    if (confirm(`Are you sure you want to cancel this ${item.type}?`)) {
                        try {
                            // Simulate API call - replace with actual endpoint
                            console.log('Cancelling item:', item.id);
                            await this.loadQueueData();
                        } catch (error) {
                            console.error('Failed to cancel item:', error);
                        }
                    }
                },

                async notifyTelegram(item) {
                    try {
                        // Simulate Telegram notification - replace with actual API call
                        console.log('Sending Telegram notification for:', item.id);
                        alert('Telegram notification sent!');
                    } catch (error) {
                        console.error('Telegram notification failed:', error);
                    }
                },

                async approveMatch(match) {
                    if (confirm('Approve this match?')) {
                        try {
                            // Simulate API call - replace with actual endpoint
                            console.log('Approving match:', match.id);
                            await this.loadQueueData();
                        } catch (error) {
                            console.error('Failed to approve match:', error);
                        }
                    }
                },

                async rejectMatch(match) {
                    if (confirm('Reject this match?')) {
                        try {
                            // Simulate API call - replace with actual endpoint
                            console.log('Rejecting match:', match.id);
                            await this.loadQueueData();
                        } catch (error) {
                            console.error('Failed to reject match:', error);
                        }
                    }
                },

                async updateItem(item) {
                    try {
                        // Simulate API call - replace with actual endpoint
                        console.log('Updating item:', item);
                        await this.loadQueueData();
                        this.showModal = false;
                    } catch (error) {
                        console.error('Failed to update item:', error);
                    }
                },

                // Utility methods
                formatDate(date) {
                    if (typeof date === 'string') date = new Date(date);
                    return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
                },

                formatWaitTime(milliseconds) {
                    const minutes = Math.floor(milliseconds / 60000);
                    const hours = Math.floor(minutes / 60);
                    if (hours > 0) return `${hours}h ${minutes % 60}m`;
                    return `${minutes}m`;
                },

                startAutoRefresh() {
                    setInterval(() => {
                        this.loadQueueData();
                    }, 30000); // Refresh every 30 seconds
                }
            };
        }
    </script>

    <!-- ==================== FIRE22 DASHBOARD WORKER FOOTER v4.0.0-staging ==================== -->
    <!-- Generated with [pk:fire22-dashboard-worker@4.0.0-staging] -->
    <footer style="
      margin-top: 60px; 
      padding: 40px 20px; 
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(15, 23, 42, 0.9) 100%); 
      color: #e2e8f0; 
      font-family: 'SF Mono', 'Monaco', 'Fira Code', monospace; 
      position: relative; 
      text-align: center;
      border-top: 2px solid rgba(253, 187, 45, 0.3);
      border-radius: 15px;
    ">
      <div style="color: #fdbb2d; font-size: 14px; line-height: 1; overflow: hidden;">
        ╭────────────────────────────────────────────────────────────────────────╮
      </div>
      
      <div style="padding: 30px 0;">
        <!-- Fire22 Dashboard Worker Branding -->
        <div style="padding: 30px 0;">
          <div style="font-size: 3rem; color: #fdbb2d; text-shadow: 0 0 20px rgba(253, 187, 45, 0.5); animation: flame-flicker 2s ease-in-out infinite;">🔥</div>
          <h2 style="font-size: 2rem; color: #fdbb2d; margin: 10px 0; font-weight: 700; letter-spacing: 2px;">Fire22 Dashboard Worker</h2>
          <p style="color: rgba(255, 255, 255, 0.8); font-size: 1.1rem; font-style: italic;">Enhanced with Bun v1.01.04-alpha features and native Bun.semver version management</p>
          <div style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-top: 10px;">
            Version: <span style="color: #fdbb2d; font-weight: bold;">4.0.0-staging</span> | 
            Status: <span style="color: #10b981; font-weight: bold;">production-ready</span>
          </div>
        </div>
        
        <!-- Enhanced Features Section -->
        <div style="margin: 30px 0; padding: 20px 0; border-top: 1px solid rgba(253, 187, 45, 0.3); border-bottom: 1px solid rgba(253, 187, 45, 0.3);">
          <div style="color: #fdbb2d; margin-bottom: 20px; font-size: 1.2rem;">
            ├─── Fire22 Dashboard Features ───┤
          </div>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; text-align: left; max-width: 1200px; margin: 0 auto;">
            <div style="color: rgba(255, 255, 255, 0.8); transition: color 0.3s; cursor: pointer;" onmouseover="this.style.color='#fdbb2d'" onmouseout="this.style.color='rgba(255, 255, 255, 0.8)'">
              ├─ 🎯 Standalone Executables with Runtime Flags
            </div>
            <div style="color: rgba(255, 255, 255, 0.8); transition: color 0.3s; cursor: pointer;" onmouseover="this.style.color='#fdbb2d'" onmouseout="this.style.color='rgba(255, 255, 255, 0.8)'">
              ├─ 🌐 Custom User Agent Management
            </div>
            <div style="color: rgba(255, 255, 255, 0.8); transition: color 0.3s; cursor: pointer;" onmouseover="this.style.color='#fdbb2d'" onmouseout="this.style.color='rgba(255, 255, 255, 0.8)'">
              ├─ 🎨 ANSI Color Support with Bun.stripANSI()
            </div>
            <div style="color: rgba(255, 255, 255, 0.8); transition: color 0.3s; cursor: pointer;" onmouseover="this.style.color='#fdbb2d'" onmouseout="this.style.color='rgba(255, 255, 255, 0.8)'">
              ├─ ⚡ Runtime Information & Diagnostics
            </div>
            <div style="color: rgba(255, 255, 255, 0.8); transition: color 0.3s; cursor: pointer;" onmouseover="this.style.color='#fdbb2d'" onmouseout="this.style.color='rgba(255, 255, 255, 0.8)'">
              ├─ 📦 Side Effects Optimization
            </div>
            <div style="color: rgba(255, 255, 255, 0.8); transition: color 0.3s; cursor: pointer;" onmouseover="this.style.color='#fdbb2d'" onmouseout="this.style.color='rgba(255, 255, 255, 0.8)'">
              ╰─ 🚀 Native Bun.semver & CLI Tooling
            </div>
          </div>
        </div>
        
        <!-- Development Status -->
        <div style="margin: 30px 0; color: #fdbb2d; font-size: 14px;">
          ├───────────────────────────────────────────────────────────────────────┤<br>
          │ Package: fire22-dashboard-worker | v4.0.0-staging | Status: ● Active   │<br>
          │ Runtime: Bun >=1.2.0 | Node: >=18.0 | Build Time: 47.2s | Tests: 54.8s│<br>
          ├───────────────────────────────────────────────────────────────────────┤
        </div>
        
        <!-- Copyright & Legal -->
        <div style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; line-height: 1.8;">
          <p>&copy; 2024 Fire22 Development Team. All rights reserved.</p>
          <p style="font-family: monospace; font-size: 0.8rem; color: rgba(255, 255, 255, 0.6);">
            Generated with <span style="color: #fdbb2d;">[pk:fire22-dashboard-worker@4.0.0-staging]</span>
          </p>
          <p style="color: rgba(255, 255, 255, 0.5); font-size: 0.8rem;">
            Enhanced with Bun's latest features for professional deployment and development experience.
          </p>
          <p>╰─────────────────────────────────────────────────────────────────╯</p>
        </div>
      </div>
      
      <div style="color: #fdbb2d; font-size: 14px; line-height: 1; overflow: hidden;">
        ╰────────────────────────────────────────────────────────────────────────╯
      </div>
    </footer>

    <!-- Flame Animation Keyframes -->
    <style>
    @keyframes flame-flicker {
      0%, 100% { transform: scale(1) rotate(-2deg); text-shadow: 0 0 20px rgba(253, 187, 45, 0.5); }
      50% { transform: scale(1.1) rotate(2deg); text-shadow: 0 0 30px rgba(253, 187, 45, 0.8); }
    }
    </style>

    <!-- Fire22 Dashboard Worker Footer v4.0.0-staging - End -->
</body>
</html>
