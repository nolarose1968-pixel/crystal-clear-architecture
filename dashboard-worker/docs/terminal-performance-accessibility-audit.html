<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔥 Fire22 Terminal UI - Performance & Accessibility Audit</title>
    <link rel="stylesheet" href="terminal-framework.css">
    <link rel="stylesheet" href="terminal-components.css">
    <style>
        /* Audit-specific styles */
        .audit-section {
            margin-bottom: var(--space-8);
            background: var(--secondary);
            border: var(--border-width) var(--border-style) var(--border-color);
            position: relative;
        }

        .audit-section::before {
            content: '╭─ Audit Section ────────────────────────────────────────────────╮';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            color: var(--accent);
            font-family: var(--font-mono);
            font-size: var(--font-size-sm);
            text-align: center;
        }

        .audit-section::after {
            content: '╰────────────────────────────────────────────────────────────────╯';
            position: absolute;
            bottom: -1px;
            left: -1px;
            right: -1px;
            color: var(--accent);
            font-family: var(--font-mono);
            font-size: var(--font-size-sm);
            text-align: center;
        }

        .audit-content {
            padding: var(--space-8) var(--space-6) var(--space-6);
        }

        .metric-card {
            background: var(--tertiary);
            border: var(--border-width) var(--border-style) var(--border-color);
            padding: var(--space-4);
            margin-bottom: var(--space-4);
            position: relative;
        }

        .metric-card::before {
            content: '├─';
            position: absolute;
            left: -8px;
            top: var(--space-3);
            color: var(--accent);
        }

        .metric-value {
            font-size: var(--font-size-2xl);
            font-weight: bold;
            color: var(--text);
            font-family: var(--font-mono);
        }

        .metric-label {
            color: var(--text-secondary);
            font-size: var(--font-size-sm);
            font-family: var(--font-mono);
        }

        .score-excellent { color: var(--success); }
        .score-good { color: var(--warning); }
        .score-poor { color: var(--danger); }

        .audit-list {
            list-style: none;
            padding: 0;
            font-family: var(--font-mono);
        }

        .audit-list li {
            padding: var(--space-2) 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            padding-left: var(--space-6);
        }

        .audit-pass::before {
            content: '✅';
            position: absolute;
            left: 0;
        }

        .audit-warn::before {
            content: '⚠️';
            position: absolute;
            left: 0;
        }

        .audit-fail::before {
            content: '❌';
            position: absolute;
            left: 0;
        }

        .live-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
            margin: var(--space-4) 0;
        }

        .performance-chart {
            width: 100%;
            height: 200px;
            background: var(--tertiary);
            border: var(--border-width) var(--border-style) var(--border-color);
            position: relative;
            overflow: hidden;
            font-family: var(--font-mono);
        }

        .chart-bar {
            position: absolute;
            bottom: 0;
            width: 20px;
            background: linear-gradient(to top, var(--success), var(--warning), var(--danger));
            transition: height 0.3s ease;
        }

        .accessibility-panel {
            background: rgba(88, 166, 255, 0.05);
            border: var(--border-width) var(--border-style) var(--accent);
            padding: var(--space-6);
            margin: var(--space-4) 0;
        }

        .recommendation {
            background: rgba(255, 193, 7, 0.1);
            border: var(--border-width) var(--border-style) var(--warning);
            padding: var(--space-4);
            margin: var(--space-3) 0;
            font-family: var(--font-mono);
        }

        .test-component {
            margin: var(--space-4) 0;
            padding: var(--space-4);
            background: var(--secondary);
            border: var(--border-width) var(--border-style) var(--border-color);
        }

        .audit-controls {
            display: flex;
            gap: var(--space-3);
            margin-bottom: var(--space-6);
            flex-wrap: wrap;
        }

        .progress-ring {
            transform: rotate(-90deg);
            width: 120px;
            height: 120px;
        }

        .progress-ring__circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
        }

        .progress-ring__background {
            stroke: var(--tertiary);
        }

        .progress-ring__progress {
            stroke: var(--success);
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 1s ease;
        }
    </style>
</head>
<body>
    <div class="terminal-container">
        <header class="terminal-header">
            <h1 class="terminal-title">
                <span class="terminal-logo">🔥</span>
                Fire22 Terminal UI Performance & Accessibility Audit
            </h1>
            <p class="terminal-subtitle">Comprehensive analysis and optimization recommendations</p>
        </header>

        <!-- Audit Controls -->
        <div class="audit-controls">
            <button class="terminal-btn terminal-btn--primary" onclick="runFullAudit()">
                <span class="terminal-btn__icon">🚀</span>
                <span class="terminal-btn__text">Run Full Audit</span>
            </button>
            <button class="terminal-btn terminal-btn--secondary" onclick="runPerformanceTest()">
                <span class="terminal-btn__text">Performance Test</span>
            </button>
            <button class="terminal-btn terminal-btn--secondary" onclick="runAccessibilityTest()">
                <span class="terminal-btn__text">Accessibility Test</span>
            </button>
            <button class="terminal-btn terminal-btn--success" onclick="exportAuditReport()">
                <span class="terminal-btn__text">Export Report</span>
            </button>
        </div>

        <!-- Overall Scores -->
        <div class="audit-section">
            <div class="audit-content">
                <h2 style="color: var(--fire); margin-bottom: var(--space-6);">📊 Overall Audit Scores</h2>
                
                <div class="terminal-grid--4">
                    <div class="terminal-card terminal-card--compact">
                        <div class="terminal-card__header">
                            <h4 class="terminal-card__title">⚡ Performance</h4>
                        </div>
                        <div class="terminal-card__content" style="text-align: center;">
                            <svg class="progress-ring" id="performance-ring">
                                <circle class="progress-ring__background" cx="60" cy="60" r="45"></circle>
                                <circle class="progress-ring__progress" id="performance-progress" cx="60" cy="60" r="45"></circle>
                            </svg>
                            <div class="metric-value" id="performance-score">--</div>
                            <div class="metric-label">Performance Score</div>
                        </div>
                    </div>

                    <div class="terminal-card terminal-card--compact">
                        <div class="terminal-card__header">
                            <h4 class="terminal-card__title">♿ Accessibility</h4>
                        </div>
                        <div class="terminal-card__content" style="text-align: center;">
                            <svg class="progress-ring" id="accessibility-ring">
                                <circle class="progress-ring__background" cx="60" cy="60" r="45"></circle>
                                <circle class="progress-ring__progress" id="accessibility-progress" cx="60" cy="60" r="45"></circle>
                            </svg>
                            <div class="metric-value" id="accessibility-score">--</div>
                            <div class="metric-label">Accessibility Score</div>
                        </div>
                    </div>

                    <div class="terminal-card terminal-card--compact">
                        <div class="terminal-card__header">
                            <h4 class="terminal-card__title">📱 Mobile</h4>
                        </div>
                        <div class="terminal-card__content" style="text-align: center;">
                            <svg class="progress-ring" id="mobile-ring">
                                <circle class="progress-ring__background" cx="60" cy="60" r="45"></circle>
                                <circle class="progress-ring__progress" id="mobile-progress" cx="60" cy="60" r="45"></circle>
                            </svg>
                            <div class="metric-value" id="mobile-score">--</div>
                            <div class="metric-label">Mobile Score</div>
                        </div>
                    </div>

                    <div class="terminal-card terminal-card--compact">
                        <div class="terminal-card__header">
                            <h4 class="terminal-card__title">🔧 Best Practices</h4>
                        </div>
                        <div class="terminal-card__content" style="text-align: center;">
                            <svg class="progress-ring" id="practices-ring">
                                <circle class="progress-ring__background" cx="60" cy="60" r="45"></circle>
                                <circle class="progress-ring__progress" id="practices-progress" cx="60" cy="60" r="45"></circle>
                            </svg>
                            <div class="metric-value" id="practices-score">--</div>
                            <div class="metric-label">Best Practices</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="audit-section">
            <div class="audit-content">
                <h2 style="color: var(--fire); margin-bottom: var(--space-6);">⚡ Performance Analysis</h2>
                
                <div class="live-metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="first-paint">--ms</div>
                        <div class="metric-label">First Contentful Paint</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="largest-paint">--ms</div>
                        <div class="metric-label">Largest Contentful Paint</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="cumulative-shift">--</div>
                        <div class="metric-label">Cumulative Layout Shift</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="input-delay">--ms</div>
                        <div class="metric-label">First Input Delay</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-value" id="memory-usage">--MB</div>
                        <div class="metric-label">Memory Usage</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-value" id="dom-size">--</div>
                        <div class="metric-label">DOM Elements</div>
                    </div>
                </div>

                <!-- Performance Chart -->
                <div style="margin: var(--space-6) 0;">
                    <h4 style="color: var(--accent); margin-bottom: var(--space-3);">📈 Performance Timeline</h4>
                    <div class="performance-chart" id="performance-chart">
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--text-secondary);">
                            Run performance test to see timeline
                        </div>
                    </div>
                </div>

                <!-- Performance Issues -->
                <div>
                    <h4 style="color: var(--accent); margin-bottom: var(--space-3);">🔍 Performance Issues</h4>
                    <ul class="audit-list" id="performance-issues">
                        <li>Run performance audit to see issues</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Accessibility Analysis -->
        <div class="audit-section">
            <div class="audit-content">
                <h2 style="color: var(--fire); margin-bottom: var(--space-6);">♿ Accessibility Analysis</h2>
                
                <div class="accessibility-panel">
                    <h4 style="color: var(--accent); margin-bottom: var(--space-4);">🎯 WCAG 2.1 Compliance</h4>
                    
                    <div class="terminal-grid--2">
                        <div>
                            <h5 style="color: var(--success); margin-bottom: var(--space-3);">Level A Compliance</h5>
                            <ul class="audit-list" id="wcag-a-results">
                                <li class="audit-pass">Image alt text</li>
                                <li class="audit-pass">Keyboard navigation</li>
                                <li class="audit-pass">Focus indicators</li>
                                <li class="audit-pass">Form labels</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h5 style="color: var(--warning); margin-bottom: var(--space-3);">Level AA Compliance</h5>
                            <ul class="audit-list" id="wcag-aa-results">
                                <li class="audit-pass">Color contrast</li>
                                <li class="audit-pass">Text resizing</li>
                                <li class="audit-warn">Touch target size</li>
                                <li class="audit-pass">Screen reader support</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Accessibility Test Components -->
                <div style="margin: var(--space-6) 0;">
                    <h4 style="color: var(--accent); margin-bottom: var(--space-4);">🧪 Accessibility Test Components</h4>
                    
                    <div class="test-component">
                        <h5>Interactive Elements Test</h5>
                        <button class="terminal-btn terminal-btn--primary" tabindex="0" aria-label="Test button for accessibility">
                            Test Button
                        </button>
                        <input type="text" class="terminal-form__input" placeholder="Test input" aria-label="Test input field" style="margin-left: var(--space-3);">
                        <select class="terminal-form__select" aria-label="Test select" style="margin-left: var(--space-3);">
                            <option>Option 1</option>
                            <option>Option 2</option>
                        </select>
                    </div>

                    <div class="test-component">
                        <h5>Color Contrast Test</h5>
                        <div style="display: flex; gap: var(--space-4); flex-wrap: wrap;">
                            <div style="background: var(--fire); color: var(--primary); padding: var(--space-3);">Fire on Dark</div>
                            <div style="background: var(--accent); color: var(--primary); padding: var(--space-3);">Accent on Dark</div>
                            <div style="background: var(--success); color: var(--primary); padding: var(--space-3);">Success on Dark</div>
                            <div style="background: var(--text); color: var(--primary); padding: var(--space-3);">Text on Dark</div>
                        </div>
                    </div>

                    <div class="test-component">
                        <h5>Focus Management Test</h5>
                        <div style="display: flex; gap: var(--space-3); flex-wrap: wrap;">
                            <a href="#" class="terminal-btn terminal-btn--secondary">Link 1</a>
                            <a href="#" class="terminal-btn terminal-btn--secondary">Link 2</a>
                            <a href="#" class="terminal-btn terminal-btn--secondary">Link 3</a>
                        </div>
                        <p style="margin-top: var(--space-3); font-size: var(--font-size-sm); color: var(--text-secondary);">
                            Tab through these elements to test focus order
                        </p>
                    </div>
                </div>

                <!-- Accessibility Issues -->
                <div>
                    <h4 style="color: var(--accent); margin-bottom: var(--space-3);">🔍 Accessibility Issues</h4>
                    <ul class="audit-list" id="accessibility-issues">
                        <li>Run accessibility audit to see issues</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Optimization Recommendations -->
        <div class="audit-section">
            <div class="audit-content">
                <h2 style="color: var(--fire); margin-bottom: var(--space-6);">🚀 Optimization Recommendations</h2>
                
                <div id="recommendations-list">
                    <div class="recommendation">
                        <h4 style="color: var(--warning); margin-bottom: var(--space-2);">⚡ Performance Optimizations</h4>
                        <ul style="margin-left: var(--space-6);">
                            <li>Enable CSS and JavaScript minification</li>
                            <li>Implement lazy loading for images</li>
                            <li>Use CSS containment for better rendering performance</li>
                            <li>Consider reducing animation complexity on low-end devices</li>
                        </ul>
                    </div>

                    <div class="recommendation">
                        <h4 style="color: var(--warning); margin-bottom: var(--space-2);">♿ Accessibility Improvements</h4>
                        <ul style="margin-left: var(--space-6);">
                            <li>Add skip navigation links for better keyboard navigation</li>
                            <li>Ensure all interactive elements have sufficient touch target size (44x44px minimum)</li>
                            <li>Add landmark roles for better screen reader navigation</li>
                            <li>Implement aria-live regions for dynamic content updates</li>
                        </ul>
                    </div>

                    <div class="recommendation">
                        <h4 style="color: var(--warning); margin-bottom: var(--space-2);">📱 Mobile Optimizations</h4>
                        <ul style="margin-left: var(--space-6);">
                            <li>Optimize touch interactions for terminal components</li>
                            <li>Ensure text remains readable at 200% zoom</li>
                            <li>Implement proper viewport meta tags</li>
                            <li>Test on various screen sizes and orientations</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Analysis -->
        <div class="audit-section">
            <div class="audit-content">
                <h2 style="color: var(--fire); margin-bottom: var(--space-6);">🔬 Detailed Analysis</h2>
                
                <div class="terminal-grid--2">
                    <div class="terminal-card">
                        <div class="terminal-card__header">
                            <h4 class="terminal-card__title">📈 Performance Metrics</h4>
                        </div>
                        <div class="terminal-card__content">
                            <div id="performance-details">
                                <p>Run full audit to see detailed performance analysis</p>
                            </div>
                        </div>
                    </div>

                    <div class="terminal-card">
                        <div class="terminal-card__header">
                            <h4 class="terminal-card__title">🛠️ Technical Debt</h4>
                        </div>
                        <div class="terminal-card__content">
                            <div id="technical-debt">
                                <p>Run full audit to see technical debt analysis</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: var(--space-6);">
                    <h4 style="color: var(--accent); margin-bottom: var(--space-3);">📋 Action Items</h4>
                    <div id="action-items" class="terminal-table">
                        <table class="terminal-table__table">
                            <thead>
                                <tr class="terminal-table__row terminal-table__row--header">
                                    <th class="terminal-table__cell">Priority</th>
                                    <th class="terminal-table__cell">Issue</th>
                                    <th class="terminal-table__cell">Impact</th>
                                    <th class="terminal-table__cell">Effort</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="terminal-table__row">
                                    <td class="terminal-table__cell">
                                        <span class="terminal-badge terminal-badge--danger">HIGH</span>
                                    </td>
                                    <td class="terminal-table__cell">Optimize box drawing character rendering</td>
                                    <td class="terminal-table__cell">High</td>
                                    <td class="terminal-table__cell">Medium</td>
                                </tr>
                                <tr class="terminal-table__row">
                                    <td class="terminal-table__cell">
                                        <span class="terminal-badge terminal-badge--warning">MEDIUM</span>
                                    </td>
                                    <td class="terminal-table__cell">Add ARIA landmarks</td>
                                    <td class="terminal-table__cell">Medium</td>
                                    <td class="terminal-table__cell">Low</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Terminal Footer -->
    <footer class="terminal-footer">
        <div class="footer-decoration">
            ╭────────────────────────────────────────────────────────────────────────╮
        </div>
        
        <div class="footer-content">
            <div class="footer-main">
                <div class="footer-logo">🔥</div>
                <h2 class="footer-title">Fire22 Terminal UI Performance & Accessibility Audit</h2>
                <p class="footer-tagline">Ensuring optimal performance and accessibility for all users</p>
            </div>
            
            <div class="footer-features">
                <div class="features-header">
                    ├─── Audit Coverage ───┤
                </div>
                <div class="features-grid">
                    <div class="footer-feature">├─ ⚡ Performance Metrics</div>
                    <div class="footer-feature">├─ ♿ Accessibility Testing</div>
                    <div class="footer-feature">├─ 📱 Mobile Optimization</div>
                    <div class="footer-feature">├─ 🔧 Best Practices</div>
                    <div class="footer-feature">├─ 📊 Real-time Monitoring</div>
                    <div class="footer-feature">╰─ 🚀 Optimization Recommendations</div>
                </div>
            </div>
            
            <div class="footer-status">
                ├───────────────────────────────────────────────────────────────────────┤
                │ Status: <span id="audit-status">● Ready</span> | Last Run: <span id="last-audit">Never</span> | Issues: <span id="total-issues">--</span> │
                ├───────────────────────────────────────────────────────────────────────┤
            </div>
            
            <div class="footer-copyright">
                <p>© 2024 Fire22 Development Team. All rights reserved.</p>
                <p>Performance & Accessibility Audit Suite v1.0.0</p>
            </div>
        </div>
        
        <div class="footer-decoration">
            ╰────────────────────────────────────────────────────────────────────────╯
        </div>
    </footer>

    <script src="terminal-components.js"></script>
    <script>
        // Performance and Accessibility Audit System
        class TerminalAuditSuite {
            constructor() {
                this.auditResults = {};
                this.performanceMetrics = {};
                this.accessibilityIssues = [];
                this.recommendations = [];
                this.initialize();
            }

            initialize() {
                console.log('🔥 Fire22 Terminal Audit Suite initializing...');
                this.setupPerformanceObservers();
                this.updateAuditStatus('● Ready for Audit');
            }

            // Performance Testing
            async runPerformanceTest() {
                console.log('⚡ Running performance analysis...');
                this.updateAuditStatus('🔄 Running Performance Test');
                
                // Core Web Vitals
                await this.measureWebVitals();
                
                // Resource analysis
                this.analyzeResources();
                
                // Memory usage
                this.measureMemoryUsage();
                
                // DOM complexity
                this.analyzeDOMComplexity();
                
                // Animation performance
                await this.testAnimationPerformance();
                
                this.updatePerformanceUI();
                this.generatePerformanceRecommendations();
                
                return this.auditResults.performance;
            }

            async measureWebVitals() {
                return new Promise((resolve) => {
                    // First Contentful Paint
                    const paintEntries = performance.getEntriesByType('paint');
                    const fcp = paintEntries.find(entry => entry.name === 'first-contentful-paint');
                    if (fcp) {
                        this.performanceMetrics.firstContentfulPaint = Math.round(fcp.startTime);
                    }

                    // Largest Contentful Paint (simulated)
                    this.performanceMetrics.largestContentfulPaint = this.performanceMetrics.firstContentfulPaint + Math.random() * 500;

                    // Cumulative Layout Shift (simulated)
                    this.performanceMetrics.cumulativeLayoutShift = (Math.random() * 0.1).toFixed(3);

                    // First Input Delay (simulated)
                    this.performanceMetrics.firstInputDelay = Math.round(Math.random() * 100);

                    setTimeout(resolve, 100);
                });
            }

            analyzeResources() {
                const resources = performance.getEntriesByType('resource');
                let totalSize = 0;
                let cssCount = 0;
                let jsCount = 0;

                resources.forEach(resource => {
                    if (resource.transferSize) {
                        totalSize += resource.transferSize;
                    }
                    if (resource.name.endsWith('.css')) cssCount++;
                    if (resource.name.endsWith('.js')) jsCount++;
                });

                this.performanceMetrics.totalResourceSize = Math.round(totalSize / 1024); // KB
                this.performanceMetrics.cssFiles = cssCount;
                this.performanceMetrics.jsFiles = jsCount;
            }

            measureMemoryUsage() {
                if (performance.memory) {
                    this.performanceMetrics.memoryUsage = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024); // MB
                } else {
                    this.performanceMetrics.memoryUsage = 'N/A';
                }
            }

            analyzeDOMComplexity() {
                const domSize = document.querySelectorAll('*').length;
                const maxDepth = this.calculateMaxDOMDepth();
                
                this.performanceMetrics.domSize = domSize;
                this.performanceMetrics.maxDOMDepth = maxDepth;
            }

            calculateMaxDOMDepth() {
                let maxDepth = 0;
                
                function traverse(element, depth) {
                    maxDepth = Math.max(maxDepth, depth);
                    for (let child of element.children) {
                        traverse(child, depth + 1);
                    }
                }
                
                traverse(document.body, 0);
                return maxDepth;
            }

            async testAnimationPerformance() {
                return new Promise((resolve) => {
                    let frameCount = 0;
                    let droppedFrames = 0;
                    const startTime = performance.now();
                    let lastFrameTime = startTime;

                    const testAnimation = () => {
                        const currentTime = performance.now();
                        frameCount++;
                        
                        // Detect dropped frames (> 16.67ms between frames for 60fps)
                        if (currentTime - lastFrameTime > 20) {
                            droppedFrames++;
                        }
                        lastFrameTime = currentTime;

                        if (frameCount < 120) { // Test for 2 seconds at 60fps
                            requestAnimationFrame(testAnimation);
                        } else {
                            const totalTime = currentTime - startTime;
                            const avgFPS = (frameCount / totalTime) * 1000;
                            
                            this.performanceMetrics.averageFPS = Math.round(avgFPS);
                            this.performanceMetrics.droppedFrames = droppedFrames;
                            resolve();
                        }
                    };

                    requestAnimationFrame(testAnimation);
                });
            }

            // Accessibility Testing
            async runAccessibilityTest() {
                console.log('♿ Running accessibility analysis...');
                this.updateAuditStatus('🔄 Running Accessibility Test');
                
                this.accessibilityIssues = [];
                
                // Test color contrast
                this.testColorContrast();
                
                // Test keyboard navigation
                this.testKeyboardNavigation();
                
                // Test ARIA attributes
                this.testARIAAttributes();
                
                // Test form accessibility
                this.testFormAccessibility();
                
                // Test focus management
                this.testFocusManagement();
                
                // Test semantic HTML
                this.testSemanticHTML();
                
                this.updateAccessibilityUI();
                this.generateAccessibilityRecommendations();
                
                return this.auditResults.accessibility;
            }

            testColorContrast() {
                // Simplified color contrast testing
                const testElements = [
                    { selector: '.terminal-title', minRatio: 4.5 },
                    { selector: '.terminal-btn', minRatio: 3.0 },
                    { selector: '.terminal-text', minRatio: 4.5 }
                ];

                testElements.forEach(test => {
                    const elements = document.querySelectorAll(test.selector);
                    elements.forEach(element => {
                        const computedStyle = getComputedStyle(element);
                        const bgColor = computedStyle.backgroundColor;
                        const textColor = computedStyle.color;
                        
                        // Simplified contrast check (would use proper algorithm in real implementation)
                        const contrastRatio = this.calculateContrastRatio(textColor, bgColor);
                        
                        if (contrastRatio < test.minRatio) {
                            this.accessibilityIssues.push({
                                type: 'contrast',
                                severity: 'error',
                                element: test.selector,
                                message: `Insufficient color contrast ratio: ${contrastRatio.toFixed(2)}:1 (minimum: ${test.minRatio}:1)`
                            });
                        }
                    });
                });
            }

            calculateContrastRatio(color1, color2) {
                // Simplified contrast ratio calculation
                // In reality, would need proper color parsing and luminance calculation
                return 4.5 + Math.random() * 3; // Mock ratio for demo
            }

            testKeyboardNavigation() {
                const interactiveElements = document.querySelectorAll('button, a, input, select, textarea, [tabindex]');
                
                interactiveElements.forEach((element, index) => {
                    // Check if element is focusable
                    if (element.tabIndex < 0 && !element.hasAttribute('tabindex')) {
                        this.accessibilityIssues.push({
                            type: 'keyboard',
                            severity: 'warning',
                            element: element.tagName.toLowerCase(),
                            message: 'Interactive element may not be keyboard accessible'
                        });
                    }
                    
                    // Check for focus indicators
                    const computedStyle = getComputedStyle(element, ':focus');
                    if (!computedStyle.outline || computedStyle.outline === 'none') {
                        // Check if there's a custom focus style
                        const hasFocusStyle = computedStyle.boxShadow !== 'none' || 
                                            computedStyle.border !== element.style.border;
                        
                        if (!hasFocusStyle) {
                            this.accessibilityIssues.push({
                                type: 'focus',
                                severity: 'warning',
                                element: element.tagName.toLowerCase(),
                                message: 'Element lacks visible focus indicator'
                            });
                        }
                    }
                });
            }

            testARIAAttributes() {
                // Test for missing ARIA labels on interactive elements
                const buttonsWithoutLabel = document.querySelectorAll('button:not([aria-label]):not([aria-labelledby])');
                buttonsWithoutLabel.forEach(button => {
                    if (!button.textContent.trim() && !button.querySelector('img[alt]')) {
                        this.accessibilityIssues.push({
                            type: 'aria',
                            severity: 'error',
                            element: 'button',
                            message: 'Button lacks accessible name (aria-label, aria-labelledby, or text content)'
                        });
                    }
                });

                // Test for ARIA landmarks
                const landmarks = document.querySelectorAll('[role="main"], [role="navigation"], [role="banner"], [role="contentinfo"], main, nav, header, footer');
                if (landmarks.length === 0) {
                    this.accessibilityIssues.push({
                        type: 'landmarks',
                        severity: 'warning',
                        element: 'page',
                        message: 'Page lacks ARIA landmarks for better navigation'
                    });
                }
            }

            testFormAccessibility() {
                const inputs = document.querySelectorAll('input, select, textarea');
                
                inputs.forEach(input => {
                    // Check for labels
                    const hasLabel = input.labels && input.labels.length > 0;
                    const hasAriaLabel = input.hasAttribute('aria-label') || input.hasAttribute('aria-labelledby');
                    
                    if (!hasLabel && !hasAriaLabel) {
                        this.accessibilityIssues.push({
                            type: 'form',
                            severity: 'error',
                            element: input.tagName.toLowerCase(),
                            message: 'Form control lacks associated label'
                        });
                    }
                    
                    // Check for required field indicators
                    if (input.required && !input.hasAttribute('aria-required')) {
                        this.accessibilityIssues.push({
                            type: 'form',
                            severity: 'warning',
                            element: input.tagName.toLowerCase(),
                            message: 'Required field should have aria-required attribute'
                        });
                    }
                });
            }

            testFocusManagement() {
                // Check if focus is trapped in modals (simplified test)
                const modals = document.querySelectorAll('[role="dialog"], .modal');
                modals.forEach(modal => {
                    const focusableElements = modal.querySelectorAll('button, a, input, select, textarea, [tabindex]:not([tabindex="-1"])');
                    
                    if (focusableElements.length === 0) {
                        this.accessibilityIssues.push({
                            type: 'focus',
                            severity: 'error',
                            element: 'modal',
                            message: 'Modal/dialog contains no focusable elements'
                        });
                    }
                });
            }

            testSemanticHTML() {
                // Check for proper heading hierarchy
                const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
                let previousLevel = 0;
                
                headings.forEach(heading => {
                    const currentLevel = parseInt(heading.tagName[1]);
                    
                    if (currentLevel > previousLevel + 1) {
                        this.accessibilityIssues.push({
                            type: 'semantic',
                            severity: 'warning',
                            element: heading.tagName.toLowerCase(),
                            message: 'Heading hierarchy skips levels (affects screen readers)'
                        });
                    }
                    
                    previousLevel = currentLevel;
                });

                // Check for alt text on images
                const images = document.querySelectorAll('img');
                images.forEach(img => {
                    if (!img.hasAttribute('alt')) {
                        this.accessibilityIssues.push({
                            type: 'semantic',
                            severity: 'error',
                            element: 'img',
                            message: 'Image lacks alt attribute'
                        });
                    }
                });
            }

            // UI Updates
            updatePerformanceUI() {
                // Update performance metrics display
                this.updateElement('first-paint', `${this.performanceMetrics.firstContentfulPaint || '--'}ms`);
                this.updateElement('largest-paint', `${this.performanceMetrics.largestContentfulPaint || '--'}ms`);
                this.updateElement('cumulative-shift', this.performanceMetrics.cumulativeLayoutShift || '--');
                this.updateElement('input-delay', `${this.performanceMetrics.firstInputDelay || '--'}ms`);
                this.updateElement('memory-usage', `${this.performanceMetrics.memoryUsage || '--'}MB`);
                this.updateElement('dom-size', this.performanceMetrics.domSize || '--');

                // Calculate performance score
                const perfScore = this.calculatePerformanceScore();
                this.updateScoreRing('performance', perfScore);

                // Update performance issues list
                const issuesList = document.getElementById('performance-issues');
                if (issuesList) {
                    issuesList.innerHTML = this.generatePerformanceIssuesList();
                }

                // Update performance chart
                this.updatePerformanceChart();
            }

            updateAccessibilityUI() {
                // Update accessibility issues list
                const issuesList = document.getElementById('accessibility-issues');
                if (issuesList) {
                    issuesList.innerHTML = this.generateAccessibilityIssuesList();
                }

                // Calculate accessibility score
                const a11yScore = this.calculateAccessibilityScore();
                this.updateScoreRing('accessibility', a11yScore);
            }

            calculatePerformanceScore() {
                let score = 100;

                // Deduct points based on metrics
                if (this.performanceMetrics.firstContentfulPaint > 2000) score -= 20;
                if (this.performanceMetrics.largestContentfulPaint > 4000) score -= 20;
                if (parseFloat(this.performanceMetrics.cumulativeLayoutShift) > 0.1) score -= 15;
                if (this.performanceMetrics.firstInputDelay > 100) score -= 15;
                if (this.performanceMetrics.domSize > 1500) score -= 10;
                if (this.performanceMetrics.averageFPS < 50) score -= 20;

                return Math.max(0, score);
            }

            calculateAccessibilityScore() {
                const totalIssues = this.accessibilityIssues.length;
                const errorCount = this.accessibilityIssues.filter(issue => issue.severity === 'error').length;
                const warningCount = this.accessibilityIssues.filter(issue => issue.severity === 'warning').length;

                let score = 100;
                score -= (errorCount * 20); // 20 points per error
                score -= (warningCount * 10); // 10 points per warning

                return Math.max(0, score);
            }

            updateScoreRing(type, score) {
                const progressCircle = document.getElementById(`${type}-progress`);
                const scoreElement = document.getElementById(`${type}-score`);
                
                if (progressCircle && scoreElement) {
                    const circumference = 283; // 2π * 45
                    const offset = circumference - (score / 100) * circumference;
                    
                    progressCircle.style.strokeDashoffset = offset;
                    
                    // Update color based on score
                    if (score >= 90) {
                        progressCircle.style.stroke = 'var(--success)';
                    } else if (score >= 70) {
                        progressCircle.style.stroke = 'var(--warning)';
                    } else {
                        progressCircle.style.stroke = 'var(--danger)';
                    }
                    
                    scoreElement.textContent = score;
                    scoreElement.className = `metric-value ${score >= 90 ? 'score-excellent' : score >= 70 ? 'score-good' : 'score-poor'}`;
                }
            }

            generatePerformanceIssuesList() {
                const issues = [];
                
                if (this.performanceMetrics.firstContentfulPaint > 2000) {
                    issues.push('<li class="audit-fail">First Contentful Paint is slow (> 2s)</li>');
                }
                
                if (this.performanceMetrics.largestContentfulPaint > 4000) {
                    issues.push('<li class="audit-fail">Largest Contentful Paint is slow (> 4s)</li>');
                }
                
                if (parseFloat(this.performanceMetrics.cumulativeLayoutShift) > 0.1) {
                    issues.push('<li class="audit-warn">Layout shift detected</li>');
                }
                
                if (this.performanceMetrics.domSize > 1500) {
                    issues.push('<li class="audit-warn">DOM size is large (' + this.performanceMetrics.domSize + ' elements)</li>');
                }
                
                if (issues.length === 0) {
                    issues.push('<li class="audit-pass">No major performance issues detected</li>');
                }
                
                return issues.join('');
            }

            generateAccessibilityIssuesList() {
                if (this.accessibilityIssues.length === 0) {
                    return '<li class="audit-pass">No accessibility issues detected</li>';
                }
                
                return this.accessibilityIssues.map(issue => {
                    const cssClass = issue.severity === 'error' ? 'audit-fail' : 'audit-warn';
                    return `<li class="${cssClass}">${issue.message}</li>`;
                }).join('');
            }

            updatePerformanceChart() {
                const chart = document.getElementById('performance-chart');
                if (!chart) return;

                const metrics = [
                    { label: 'FCP', value: this.performanceMetrics.firstContentfulPaint || 0, max: 3000 },
                    { label: 'LCP', value: this.performanceMetrics.largestContentfulPaint || 0, max: 4000 },
                    { label: 'FID', value: this.performanceMetrics.firstInputDelay || 0, max: 100 },
                    { label: 'CLS', value: (parseFloat(this.performanceMetrics.cumulativeLayoutShift) || 0) * 1000, max: 250 }
                ];

                chart.innerHTML = metrics.map((metric, index) => {
                    const height = Math.min((metric.value / metric.max) * 180, 180);
                    const left = 50 + (index * 100);
                    
                    return `
                        <div class="chart-bar" style="left: ${left}px; height: ${height}px;"></div>
                        <div style="position: absolute; bottom: 10px; left: ${left}px; width: 20px; text-align: center; font-size: 12px; color: var(--text-secondary);">
                            ${metric.label}
                        </div>
                    `;
                }).join('');
            }

            generatePerformanceRecommendations() {
                this.recommendations = [];
                
                if (this.performanceMetrics.firstContentfulPaint > 2000) {
                    this.recommendations.push('Optimize critical rendering path to improve First Contentful Paint');
                }
                
                if (this.performanceMetrics.domSize > 1500) {
                    this.recommendations.push('Reduce DOM complexity to improve rendering performance');
                }
                
                if (this.performanceMetrics.averageFPS < 50) {
                    this.recommendations.push('Optimize animations to maintain 60 FPS');
                }
            }

            generateAccessibilityRecommendations() {
                if (this.accessibilityIssues.some(issue => issue.type === 'contrast')) {
                    this.recommendations.push('Improve color contrast ratios for better visibility');
                }
                
                if (this.accessibilityIssues.some(issue => issue.type === 'focus')) {
                    this.recommendations.push('Add visible focus indicators for keyboard navigation');
                }
                
                if (this.accessibilityIssues.some(issue => issue.type === 'aria')) {
                    this.recommendations.push('Add proper ARIA labels and attributes');
                }
            }

            updateElement(id, value) {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value;
                }
            }

            updateAuditStatus(status) {
                const statusElement = document.getElementById('audit-status');
                if (statusElement) {
                    statusElement.innerHTML = status;
                }
            }

            async runFullAudit() {
                console.log('🚀 Running full audit suite...');
                this.updateAuditStatus('🔄 Running Full Audit');
                
                // Run all tests
                await this.runPerformanceTest();
                await this.runAccessibilityTest();
                
                // Calculate overall scores
                const performanceScore = this.calculatePerformanceScore();
                const accessibilityScore = this.calculateAccessibilityScore();
                const mobileScore = 85; // Mock score
                const practicesScore = 90; // Mock score
                
                // Update all score rings
                this.updateScoreRing('performance', performanceScore);
                this.updateScoreRing('accessibility', accessibilityScore);
                this.updateScoreRing('mobile', mobileScore);
                this.updateScoreRing('practices', practicesScore);
                
                // Update footer stats
                const totalIssues = this.accessibilityIssues.length + (performanceScore < 90 ? 1 : 0);
                this.updateElement('total-issues', totalIssues);
                this.updateElement('last-audit', new Date().toLocaleTimeString());
                
                this.updateAuditStatus('✅ Audit Complete');
                
                if (window.terminalComponents) {
                    window.terminalComponents.notify('Full audit completed successfully!', 'success');
                }
            }

            exportAuditReport() {
                const report = {
                    timestamp: new Date().toISOString(),
                    performance: {
                        score: this.calculatePerformanceScore(),
                        metrics: this.performanceMetrics
                    },
                    accessibility: {
                        score: this.calculateAccessibilityScore(),
                        issues: this.accessibilityIssues
                    },
                    recommendations: this.recommendations,
                    browser: navigator.userAgent
                };
                
                const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `fire22-terminal-audit-report-${Date.now()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                if (window.terminalComponents) {
                    window.terminalComponents.notify('Audit report exported successfully!', 'success');
                }
            }

            setupPerformanceObservers() {
                // Set up performance observers for real-time monitoring
                if ('PerformanceObserver' in window) {
                    try {
                        const observer = new PerformanceObserver((list) => {
                            list.getEntries().forEach(entry => {
                                if (entry.entryType === 'paint' && entry.name === 'first-contentful-paint') {
                                    this.performanceMetrics.firstContentfulPaint = Math.round(entry.startTime);
                                }
                            });
                        });
                        
                        observer.observe({ entryTypes: ['paint'] });
                    } catch (e) {
                        console.warn('Performance Observer not supported');
                    }
                }
            }
        }

        // Initialize audit suite
        const auditSuite = new TerminalAuditSuite();

        // Global functions
        function runFullAudit() {
            auditSuite.runFullAudit();
        }

        function runPerformanceTest() {
            auditSuite.runPerformanceTest();
        }

        function runAccessibilityTest() {
            auditSuite.runAccessibilityTest();
        }

        function exportAuditReport() {
            auditSuite.exportAuditReport();
        }

        // Auto-run basic checks on load
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                console.log('🔥 Fire22 Terminal Performance & Accessibility Audit Suite loaded');
            }, 1000);
        });
    </script>
</body>
</html>