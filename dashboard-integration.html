<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Domain Integration Dashboard</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        min-height: 100vh;
        padding: 20px;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }
      .header {
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }
      .header h1 {
        font-size: 2.5em;
        font-weight: 300;
        margin-bottom: 10px;
      }
      .header p {
        font-size: 1.1em;
        opacity: 0.9;
      }
      .nav {
        background: #f8f9fa;
        padding: 0;
        display: flex;
        border-bottom: 1px solid #e9ecef;
      }
      .nav-item {
        flex: 1;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: background 0.2s;
        border-right: 1px solid #e9ecef;
      }
      .nav-item:last-child {
        border-right: none;
      }
      .nav-item:hover {
        background: #e9ecef;
      }
      .nav-item.active {
        background: #007acc;
        color: white;
        font-weight: bold;
      }
      .content {
        padding: 30px;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }
      .stat-card {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 25px;
        text-align: center;
        border-left: 4px solid #007acc;
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease;
      }
      .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }
      .stat-value {
        font-size: 2.5em;
        font-weight: bold;
        color: #007acc;
        margin: 10px 0;
      }
      .stat-label {
        font-size: 1.1em;
        color: #666;
        margin-bottom: 15px;
      }
      .data-section {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
      }
      .data-section h3 {
        margin-bottom: 15px;
        color: #2c3e50;
        border-bottom: 2px solid #007acc;
        padding-bottom: 5px;
      }
      .data-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }
      .data-item {
        background: white;
        padding: 15px;
        border-radius: 6px;
        border: 1px solid #e9ecef;
      }
      .data-item h4 {
        color: #007acc;
        margin-bottom: 10px;
      }
      .data-item pre {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        font-size: 0.9em;
        overflow-x: auto;
        max-height: 200px;
        overflow-y: auto;
      }
      .actions {
        display: flex;
        gap: 10px;
        margin: 20px 0;
        flex-wrap: wrap;
      }
      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.2s;
      }
      .btn-primary {
        background: #007acc;
        color: white;
      }
      .btn-primary:hover {
        background: #0056b3;
      }
      .btn-secondary {
        background: #6c757d;
        color: white;
      }
      .btn-secondary:hover {
        background: #545b62;
      }
      .btn-success {
        background: #28a745;
        color: white;
      }
      .btn-success:hover {
        background: #1e7e34;
      }
      .footer {
        background: #2c3e50;
        color: white;
        padding: 20px 30px;
        text-align: center;
      }
      .footer p {
        margin: 5px 0;
        font-size: 0.9em;
      }
      .status-indicator {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #28a745;
        margin-left: 10px;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }
      .loading {
        text-align: center;
        padding: 20px;
        color: #666;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
        padding: 15px;
        border-radius: 6px;
        margin: 10px 0;
        border: 1px solid #f5c6cb;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üöÄ Domain Integration Dashboard</h1>
        <p>Bun Runtime ‚Ä¢ SQLite ‚Ä¢ YAML ‚Ä¢ Secrets ‚Ä¢ HTML Templates</p>
      </div>

      <div class="nav">
        <div class="nav-item active" onclick="showSection('overview')">
          Overview
        </div>
        <div class="nav-item" onclick="showSection('accounts')">Accounts</div>
        <div class="nav-item" onclick="showSection('bets')">Bets</div>
        <div class="nav-item" onclick="showSection('config')">Config</div>
      </div>

      <div class="content">
        <!-- Overview Section -->
        <div id="overview-section" class="section">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-label">Total Accounts</div>
              <div class="stat-value" id="accounts-count">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Active Bets</div>
              <div class="stat-value" id="bets-count">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Total Balance</div>
              <div class="stat-value" id="total-balance">$0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">System Status</div>
              <div class="stat-value">üü¢ Online</div>
            </div>
          </div>

          <div class="data-section">
            <h3>System Information</h3>
            <div class="data-grid">
              <div class="data-item">
                <h4>üïê Timezone</h4>
                <p id="timezone-info">Loading...</p>
              </div>
              <div class="data-item">
                <h4>üîÑ Last Updated</h4>
                <p id="last-updated">Loading...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Accounts Section -->
        <div id="accounts-section" class="section" style="display: none">
          <div class="data-section">
            <h3>Domain Accounts</h3>
            <div class="actions">
              <button class="btn btn-success" onclick="createAccount()">
                Create New Account
              </button>
              <button class="btn btn-primary" onclick="refreshAccounts()">
                Refresh
              </button>
            </div>
            <div id="accounts-data">
              <div class="loading">Loading accounts...</div>
            </div>
          </div>
        </div>

        <!-- Bets Section -->
        <div id="bets-section" class="section" style="display: none">
          <div class="data-section">
            <h3>Domain Bets</h3>
            <div class="actions">
              <button class="btn btn-success" onclick="createBet()">
                Create New Bet
              </button>
              <button class="btn btn-primary" onclick="refreshBets()">
                Refresh
              </button>
            </div>
            <div id="bets-data">
              <div class="loading">Loading bets...</div>
            </div>
          </div>
        </div>

        <!-- Config Section -->
        <div id="config-section" class="section" style="display: none">
          <div class="data-section">
            <h3>Configuration</h3>
            <div id="config-data">
              <div class="loading">Loading configuration...</div>
            </div>
          </div>
        </div>
      </div>

      <div class="footer">
        <p>üî• Powered by Bun Runtime | Domain-Driven Architecture</p>
        <p>üìä SQLite ‚Ä¢ YAML ‚Ä¢ Secrets ‚Ä¢ HTML Templates ‚Ä¢ Hot Reload</p>
        <p>üü¢ Live Status <span class="status-indicator"></span></p>
      </div>
    </div>

    <script>
      // Global state
      let currentSection = "overview";

      // Navigation
      function showSection(sectionName) {
        // Hide all sections
        document.querySelectorAll(".section").forEach((section) => {
          section.style.display = "none";
        });

        // Remove active class from nav items
        document.querySelectorAll(".nav-item").forEach((item) => {
          item.classList.remove("active");
        });

        // Show selected section
        document.getElementById(sectionName + "-section").style.display =
          "block";

        // Add active class to selected nav item
        event.target.classList.add("active");

        currentSection = sectionName;

        // Load data for section
        loadSectionData(sectionName);
      }

      // Load data for current section
      async function loadSectionData(section) {
        try {
          switch (section) {
            case "overview":
              await loadStats();
              break;
            case "accounts":
              await loadAccounts();
              break;
            case "bets":
              await loadBets();
              break;
            case "config":
              await loadConfig();
              break;
          }
        } catch (error) {
          console.error("Error loading section data:", error);
          showError("Failed to load data: " + error.message);
        }
      }

      // Load overview stats
      async function loadStats() {
        const response = await fetch("/api/domain/stats");
        const stats = await response.json();

        document.getElementById("accounts-count").textContent =
          stats.accountsCount;
        document.getElementById("bets-count").textContent = stats.betsCount;
        document.getElementById("total-balance").textContent =
          "$" + stats.totalBalance.toFixed(2);
        document.getElementById("timezone-info").textContent = stats.timezone;
        document.getElementById("last-updated").textContent = new Date(
          stats.lastUpdated,
        ).toLocaleString();
      }

      // Load accounts
      async function loadAccounts() {
        const response = await fetch("/api/domain/accounts");
        const accounts = await response.json();

        const container = document.getElementById("accounts-data");
        if (accounts.length === 0) {
          container.innerHTML = "<p>No accounts found.</p>";
          return;
        }

        container.innerHTML =
          "<pre>" + JSON.stringify(accounts, null, 2) + "</pre>";
      }

      // Load bets
      async function loadBets() {
        const response = await fetch("/api/domain/bets");
        const bets = await response.json();

        const container = document.getElementById("bets-data");
        if (bets.length === 0) {
          container.innerHTML = "<p>No bets found.</p>";
          return;
        }

        container.innerHTML =
          "<pre>" + JSON.stringify(bets, null, 2) + "</pre>";
      }

      // Load configuration
      async function loadConfig() {
        const response = await fetch("/api/domain/config");
        const config = await response.json();

        document.getElementById("config-data").innerHTML =
          "<pre>" + JSON.stringify(config, null, 2) + "</pre>";
      }

      // Create new account
      async function createAccount() {
        try {
          const response = await fetch(
            "/api/domain/operations/create-account",
            {
              method: "POST",
            },
          );
          const result = await response.json();

          if (result.success) {
            showSuccess("Account created successfully!");
            loadAccounts();
            loadStats();
          } else {
            showError("Failed to create account: " + result.error);
          }
        } catch (error) {
          showError("Error creating account: " + error.message);
        }
      }

      // Create new bet
      async function createBet() {
        try {
          const response = await fetch("/api/domain/operations/create-bet", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({}),
          });
          const result = await response.json();

          if (result.success) {
            showSuccess("Bet created successfully!");
            loadBets();
            loadStats();
          } else {
            showError("Failed to create bet: " + result.error);
          }
        } catch (error) {
          showError("Error creating bet: " + error.message);
        }
      }

      // Refresh functions
      function refreshAccounts() {
        loadAccounts();
      }
      function refreshBets() {
        loadBets();
      }

      // Utility functions
      function showSuccess(message) {
        const div = document.createElement("div");
        div.className = "success";
        div.style.cssText =
          "background: #d4edda; color: #155724; padding: 15px; border-radius: 6px; margin: 10px 0; border: 1px solid #c3e6cb;";
        div.textContent = "‚úÖ " + message;

        const content = document.querySelector(".content");
        content.insertBefore(div, content.firstChild);

        setTimeout(() => div.remove(), 5000);
      }

      function showError(message) {
        const div = document.createElement("div");
        div.className = "error";
        div.textContent = "‚ùå " + message;

        const content = document.querySelector(".content");
        content.insertBefore(div, content.firstChild);

        setTimeout(() => div.remove(), 5000);
      }

      // Auto-refresh stats every 30 seconds
      setInterval(() => {
        if (currentSection === "overview") {
          loadStats();
        }
      }, 30000);

      // Initial load
      document.addEventListener("DOMContentLoaded", () => {
        loadSectionData("overview");
      });

      // Console logging for development
      console.log("üöÄ Domain Integration Dashboard loaded");
      console.log(
        "üî• Hot-reload enabled - changes will be reflected automatically",
      );
    </script>
  </body>
</html>
